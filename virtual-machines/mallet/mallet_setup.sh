#!/usr/bin/env bash

# To be run inside mallet
# But first, make sure that in the VirtualBox
# network configuration mallet is in the internal network InfSec_WAN

sudo ifconfig eth4 192.168.1.3
sudo ifconfig eth4 up
sudo route del default
sudo route add default gw 192.168.1.129 eth4
sudo sh -c 'echo "192.168.1.129\timovies.ch\n$(cat /etc/hosts)" > /etc/hosts'
private_key="-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----
"

mkdir /home/mallet/.ssh/
echo $private_key > /home/mallet/.ssh/id_rsa

public_key="ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCioxuOmXGIB2dSZxAG6+1u/kTqlLQLi9pFrm4FntjpO2cIUDqCZPz/CneRle91uFwIinHmj6Afd0Of5b6QD9ls4d3p3XlRJce8ZnQLeIKuGGTzJke8TDiFQNqob6eM8MbE5eEek0gnCYMIwyQbpAkE1w9WxlZRSZC3D+67JK5KpOv2AXR7VhduxQ489b0PSJKrplUpAVpMKeVVA6JfrrxoUvNdrL5jKo7Hf9WGni51Xj7UI9iDRU7RSsgV49lFn3NwLfcn9izJ9Qm880mm+tKM4PkgCIxAV2xKaSnW30sD8XwPfJnGWXrxD51Bnm+UazO5Ktssi1V2gdQHIlVcfTqw7T4iDkXv+Jl7fUDBrWJ4lEdi7yxDluPjDWkj957vnjZkIwsnbef9dvdiXXeQVrm3deLJPS9rflaayEljTGBu/525924bWg/eWfTdXuFRD5++ud+Kn8GNrjwXRxjKD22UqfiVPppua+S0xhlvywcx/yz+neP06z241XCmRr3/79OgPOeo8M5ggQQu085DP9p+PR4cfKG5mghuMhJNrKAci5a19uqZuNkUxwky2H64peXhIn/EdJNmM9vdCi9t+wGHDEnMoGLBC9F6mCnax9uklsa9xsvQm/M0kWGWimDktTHd1bYWBTLfRBhmQ2CTlzbc30LWtNepFWi3QD8RkIBGbQ== mallet@mallet.com
"
echo $public_key > /home/mallet/.ssh/id_rsa.pub


eval "$(ssh-agent -s)"
sudo chmod 600 .ssh/*
ssh-add /home/mallet/.ssh/id_rsa